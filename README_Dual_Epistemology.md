# FILE: README_Dual_Epistemology.md

# Franz — Dual Epistemology (Orange/Blue Mean Something)

This drop-in version modernizes the stateless vision-loop agent into a **dual epistemology** system:

- **Orange** = controller-executed action heat (ground truth)
- **Blue (WORLD)** = controller-computed markers from pixels (dashed boxes W*)
- **Blue (SELF)** = model-chosen candidate pieces (solid boxes B0/B1/B2)

The model writes a narrative diary (**phenomenology**) and a structured reasoning object (**epistemology**), but only the **audit** generated by the engine is treated as state.

## Files
- `main.py` — engine + capture + execution + VLM call + HTTP server
- `config.py` — prompts, regex fallbacks, UI styling, capture crop, toggles
- `panel.html` — Chrome UI; exports annotated images for the VLM using *world-only* overlays

## Quick start
1) Copy these files into your project folder:
   - `main.py`
   - `config.py`
   - `panel.html`
2) Ensure `CAPTURE_CROP` tightly covers ONLY the chessboard.
3) Run:

```bat
py -3.13 main.py
```

The UI opens in Chrome at `http://127.0.0.1:1234/`.

## Export mode (important)
The browser posts `/annotated` back to the engine. That annotated image is what the VLM sees when `VLM_IMAGE_SOURCE="annotated"`.

`UI_CONFIG["vlm_export"]["mode"]`:
- `world_only` — only WORLD W* boxes (best for purity)
- `world_and_actions` — WORLD W* boxes + ORANGE executed heat (recommended)
- `full` — WORLD + SELF + ORANGE (not recommended: model will see its own overlays)

## Regex fallbacks
If the VLM returns messy output, the engine can fall back to regex patterns in `config.py`:
- `PARSE_REGEX_ORANGE_ACTIONS`
- `PARSE_REGEX_BLUE_BBOXES`
- `PARSE_REGEX_UCI`

## Notes
- This repo intentionally uses **stdlib + ctypes + WinAPI only**.
- The WORLD markers are heuristic: they are *evidence* and are allowed to be wrong.
